# 防火墙和网络地址转换

# 7.1 引言

NAT解决了IPV4地址逐渐枯竭的问题。

# 7.2 防火墙

目前最常见的防火墙有代理防火墙和包过滤防火墙。

### 7.2.1 包过滤防火墙

可以过滤掉不符合规定条件的网络流量。简单的过滤器包括网络层或者传输层报头中各个部分的范围比较。最简单的包过滤防火墙是无状态的，更复杂的防火墙是有状态的。无状态的防火墙单独处理每一个数据报，而有状态的防火墙能够推断即将到来的数据报的信息，对那些属于同一个来源的数据报进行处理。

### 7.2.2 代理防火墙

实际上就是一个处理内部请求，并对内部主机进行响应的中介主机。内部主机的传输终点就是代理防火墙。常见的就是http代理和socks代理。

# 7.3 NAT

NAT的本质就是一种允许互联网不同地方的IP地址重复使用的机制，它解决了IPV4地址紧张的问题。使用NAT时，与Internet相连接的站点只分配了一个或者几个很少的IPV4地址，但是内部却有多台主机需要上网。这时，所有的上网设备都需要经过NAT设备，该设备将内部系统和Internet分隔，因此，所有内部系统可以共用一个公用地址访问Internet。

NAT在IPV4枯竭的前提下非常有实现的必要，但随着IPV6的推广，就不再需要NAT了。

在传输的过程中，NAT必须重写每一个数据报的寻址信息和校验信息。它的工作原理就是通过重写路由器的寻址信息，来实现共用公用地址。

大多数的NAT同时执行包过滤和执行转换，包过滤的标准取决于NAT的动态状态。